const { Alice, Reply } = require('@yandex-cloud/alice-sdk');

// Создаем экземпляр навыка
const alice = new Alice();

// Обработчик входящих запросов
alice.on('request', async (req, res) => {
  // Проверяем, что запрос — это запуск навыка
  if (req.isLaunch) {
    // Алиса говорит "Доброе утро"
    res.appendText('Доброе утро!');

    // Устанавливаем таймер на 3 минуты (180000 миллисекунд)
    setTimeout(() => {
      // Отправляем дополнительное сообщение "Вы проснулись?"
      // Для этого нужно использовать механизм push-уведомлений или сессию
      res.appendText('Вы проснулись?');
    }, 180000);

    // Возвращаем ответ, чтобы не закрывать сессию
    return Reply.text('Доброе утро!', { endSession: false });
  }

  // Если это не запуск, возвращаем пустой ответ
  return Reply.text('');
});

// Запуск сервера (для локального тестирования или деплоя)
const port = process.env.PORT || 3000;
alice.listen(port, () => {
  console.log(`Сервер запущен на порту ${port}`);
});